<!doctype html>
<html>
<head>
  <meta charset='utf-8' />

  <%#= wicked_pdf_stylesheet_link_tag "application", media: "all" %>
  <%#= wicked_pdf_stylesheet_link_tag "tailwind" %>
  <%= wicked_pdf_stylesheet_pack_tag %>
  <%= wicked_pdf_javascript_include_tag "number_pages" %>

  <style>
      .max-w-3xl {
          max-width: 48rem;
      }
      .mx-auto {
          margin-left: auto;
          margin-right: auto;
      }
      .p-6 {
          padding: 1.5rem;
      }
      .bg-white {
          background-color: white;
      }
      .rounded {
          border-radius: 0.375rem;
      }
      .shadow-sm {
          box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      }
      .my-6 {
          margin-top: 1.5rem;
          margin-bottom: 1.5rem;
      }
      .justify-between {
          justify-content: space-between;
      }
      .flex {
          display: flex;
      }
      .w-96 {
          width: 24rem;
      }
      .text-gray-500 {
          color: #6b7280;
      }
      .text-sm {
          font-size: 0.875rem;
      }
      .font-bold {
          font-weight: 700;
      }
      .text-gray-800 {
          color: #1f2937;
      }
      .text-right {
          text-align: right;
      }
      .mr-4 {
          margin-right: 1rem;
      }
      .mt-1 {
          margin-top: 0.25rem;
      }
      .w-32 {
          width: 8rem;
      }
      .h-32 {
          height: 8rem;
      }
      .mt-8 {
          margin-top: 2rem;
      }
      .-mx-4 {
          margin-left: -1rem;
          margin-right: -1rem;
      }
      .flow-root {
          display: flow-root;
      }
      .min-w-full {
          min-width: 100%;
      }
      .border-b {
          border-bottom-width: 1px;
      }
      .border-gray-100 {
          border-color: #f3f4f6;
      }
      .bg-gray-100 {
          background-color: #f3f4f6;
      }
      .py-3\.5 {
          padding-top: 0.875rem;
          padding-bottom: 0.875rem;
      }
      .pl-4 {
          padding-left: 1rem;
      }
      .pr-3 {
          padding-right: 0.75rem;
      }
      .sm\:pl-0 {
          padding-left: 0;
      }
      .hidden {
          display: none;
          visibility: hidden;
      }
      .px-3 {
          padding-left: 0.75rem;
          padding-right: 0.75rem;
      }
      .sm\:table-cell {
          display: table-cell;
      }
      .pl-3 {
          padding-left: 0.75rem;
      }
      .sm\:pr-0 {
          padding-right: 0;
      }
      .text-center {
          text-align: center;
      }
      .font-semibold {
          font-weight: 600;
      }
      .text-gray-900 {
          color: #111827;
      }
      .text-center {
          text-align: center;
      }
  </style>
</head>
<body onload="number_pages()">
<div class="p-6 pt-4">
  <p class="font-bold">Title</p>
  <p>
    <span><%= @hack.title %>
      <span class="<%= class_for_boolean(@hack.hack_validation.present? ? @hack.hack_validation.status : @hack.is_hack?) %> inline-block ml-2"><%= text_for_boolean(@hack.hack_validation.present? ? @hack.hack_validation.status : @hack.is_hack?) %></span>
    </span>
  </p>

  <p class="font-bold mt-4">Summary</p>
  <p><%= raw(@markdown.render(@hack.summary)) if @hack.summary%></p>

  <p class="font-bold mt-4">Justification</p>
  <p><%= raw(@markdown.render(@hack.justification)) if @hack.justification %></p>

  <p class="font-bold mt-4">Video Transcription</p>
  <p><%= raw(@markdown.render(@hack.video.transcription.content)) %></p>
  <a href="<%= @hack.video.source_link %>" target="_blank" class="text-blue-600 dark:text-blue-500 hover:underline">Ver video</a>

  <% if @hack.is_hack? %>
    <p class="font-bold mt-4">Queries</p>
    <ul class="pl-4">
      <% @hack.queries.each do |query| %>
        <li><%= query.content.capitalize %></li>
      <% end %>
    </ul>
  <% end %>
</div>

<% if @hack.hack_structured_info %>
  <div class="p-6">
    <p class="font-bold">Extended Title</p>
    <p>
      <span><%= @hack.hack_structured_info.extended_title %>
        <span class="<%= class_for_boolean(@hack.hack_validation.present? ? @hack.hack_validation.status : @hack.is_hack?) %> inline-block ml-2"><%= text_for_boolean(@hack.hack_validation.present? ? @hack.hack_validation.status : @hack.is_hack?) %></span>
      </span>
    </p>

    <p class="font-bold mt-4">Description</p>
    <p class=""><%= raw(@markdown.render(@hack.hack_structured_info.description)) %></p>

    <p class="font-bold mt-4">Categories</p>
    <p><ul class="list-disc list-outside pl-5">
    <% @hack.hack_category_rels.each do |hack_category_rels| %>
      <li class="mb-2">
        <div class="inline-flex">
          <h5 class="font-semibold"><%= hack_category_rels.category.name %></h5>
          <div class="flex items-center py-0.5 ">
            <svg data-popover-target="category-info-<%= hack_category_rels.category.id %>" data-popover-placement="bottom"
                 class="w-3.5 h-3.5 text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white cursor-pointer ms-1"
                 aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
              <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm0 16a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3Zm1-5.034V12a1 1 0 0 1-2 0v-1.418a1 1 0 0 1 1.038-.999 1.436 1.436 0 0 0 1.488-1.441 1.501 1.501 0 1 0-3-.116.986.986 0 0 1-1.037.961 1 1 0 0 1-.96-1.037A3.5 3.5 0 1 1 11 11.466Z"/>
            </svg>
            <div data-popover id="category-info-<%= hack_category_rels.category.id %>" role="tooltip"
                 class="absolute z-10 invisible inline-block text-sm text-gray-500 transition-opacity duration-300 bg-white border border-gray-200 rounded-lg shadow-sm opacity-0 w-72 dark:bg-gray-800 dark:border-gray-600 dark:text-gray-400">
              <div class="p-3 space-y-2">
                <p class="text-sm normal-case font-normal"><%= hack_category_rels.category.description %></p>
              </div>
              <div data-popper-arrow></div>
            </div>
          </div>
        </div>
        <p><%= hack_category_rels.justification %></p>
      </li>
    <% end %>
  </ul></p>

    <p class="font-bold mt-4">Main goal</p>
    <p><%= raw(@markdown.render(@hack.hack_structured_info.main_goal)) %></p>

    <p class="font-bold mt-4">Steps Summary</p>
    <p><%= raw(@markdown.render(@hack.hack_structured_info.steps_summary)) %></p>

    <p class="font-bold mt-4">Resources Needed</p>
    <p><%= raw(@markdown.render(@hack.hack_structured_info.resources_needed)) %></p>

    <p class="font-bold mt-4">Expected Benefits</p>
    <p><%= raw(@markdown.render(@hack.hack_structured_info.expected_benefits)) %></p>

    <p class="font-bold mt-4">Detailed Steps</p>
    <p><%= raw(@markdown.render(@hack.hack_structured_info.detailed_steps)) %></p>

    <p class="font-bold mt-4">Additional tools resources</p>
    <p><%= raw(@markdown.render(@hack.hack_structured_info.additional_tools_resources)) %></p>

    <p class="font-bold mt-4">Case Study</p>
    <p><%= raw(@markdown.render(@hack.hack_structured_info.case_study)) %></p>

    <p class="font-bold mt-4">Validation Sources</p>
    <ul class="pl-4">
      <% validation_links = @hack.hack_validation&.links%>
      <% validation_links ||= "[]" %>
      <% validation_links = JSON.parse(validation_links) %>
      <% validation_links.each do |link| %>
        <li>
          <a href="<%= link %>" target="_blank" class=" dark:text-blue-500 hover:underline"><%= link %></a>
        </li>
      <% end %>
    </ul>

    <p class="font-bold mt-4">Scraped Sources</p>
    <ul class="pl-4">
      <% @hack.scraped_results.each do |scraped_result| %>
        <li>
          <a href="<%= scraped_result.link %>" target="_blank" class=" dark:text-blue-500 hover:underline"><%= scraped_result.link %></a>
        </li>
      <% end %>
    </ul>

  </div>
<% end %>
</body>
</html>